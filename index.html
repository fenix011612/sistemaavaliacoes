<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Sistema de Avalia√ß√µes</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  font-family: 'Segoe UI', sans-serif;
  background: linear-gradient(135deg, #f4f6ff, #eef2ff);
  margin: 0;
  padding: 20px;
}

.container {
  max-width: 650px;
  margin: auto;
  background: white;
  padding: 25px;
  border-radius: 20px;
  box-shadow: 0 15px 40px rgba(0,0,0,0.08);
}

h2 {
  text-align: center;
  margin-bottom: 25px;
  color: #333;
}

.hidden { display: none; }

button {
  padding: 10px 15px;
  margin: 8px 0;
  cursor: pointer;
  border: none;
  border-radius: 12px;
  font-weight: 600;
  transition: 0.2s;
}

button:hover {
  transform: translateY(-2px);
  opacity: 0.9;
}

button.primary {
  background: #6c63ff;
  color: white;
}

button.secondary {
  background: #e2e6ff;
  color: #333;
}

button.success {
  background: #00c896;
  color: white;
}

input, select {
  width: 100%;
  padding: 10px;
  margin: 8px 0;
  border-radius: 10px;
  border: 1px solid #ddd;
  font-size: 14px;
}

.card {
  border: none;
  padding: 15px;
  margin: 12px 0;
  border-radius: 15px;
  background: #f8f9ff;
  box-shadow: 0 8px 20px rgba(0,0,0,0.05);
  transition: 0.2s;
}

.card:hover {
  transform: translateY(-3px);
}

.card strong {
  font-size: 16px;
  color: #333;
}

small {
  color: #777;
}
</style>
</head>

<body>

<div class="container">

<h2>Sistema de Avalia√ß√µes</h2>

<!-- MENU -->
<div id="menu">
<button class="primary" onclick="mostrarFormulario()">Nova Avalia√ß√£o</button>
<button class="secondary" onclick="mostrarLista()">Ver Avalia√ß√µes</button>
</div>

<!-- FORM -->
<div id="formulario" class="hidden">
<h3>Nova Avalia√ß√£o</h3>

<form onsubmit="salvar(event)">
<input name="nome" placeholder="Nome do paciente" required>

<select name="tipo" required>
<option value="">Selecione o tipo</option>
<option value="fisio">Fisioterapia</option>
<option value="pilates">Pilates</option>
<option value="pelvica">P√©lvica</option>
<option value="recovery">Recovery</option>
</select>

<button class="success" type="submit">Salvar</button>
</form>

<button class="secondary" onclick="voltarMenu()">Voltar</button>
</div>

<!-- LISTA -->
<div id="lista" class="hidden">
<h3>Avalia√ß√µes Salvas</h3>
<div id="listaContainer"></div>
<button class="secondary" onclick="voltarMenu()">Voltar</button>
</div>

</div>

<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
import { getDatabase, ref, push, onValue } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-database.js";

/* üî• SEU FIREBASE */
const firebaseConfig = {
  apiKey: "AIzaSyAFNuEzaEvvpBKBGNG7NUf3zt74Q3r1fdo",
  authDomain: "sistemaavaliacoes-26513.firebaseapp.com",
  databaseURL: "https://sistemaavaliacoes-26513-default-rtdb.firebaseio.com",
  projectId: "sistemaavaliacoes-26513",
  storageBucket: "sistemaavaliacoes-26513.firebasestorage.app",
  messagingSenderId: "451297691104",
  appId: "1:451297691104:web:1f886ad169a54c4f8fd785"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

console.log("üî• Firebase conectado com sucesso!");

/* ===== NAVEGA√á√ÉO ===== */

window.mostrarFormulario = function(){
  document.getElementById("menu").classList.add("hidden");
  document.getElementById("formulario").classList.remove("hidden");
}

window.mostrarLista = function(){
  document.getElementById("menu").classList.add("hidden");
  document.getElementById("lista").classList.remove("hidden");
  carregar();
}

window.voltarMenu = function(){
  document.getElementById("menu").classList.remove("hidden");
  document.getElementById("formulario").classList.add("hidden");
  document.getElementById("lista").classList.add("hidden");
}

/* ===== SALVAR ===== */

window.salvar = function(e){
  e.preventDefault();

  const dados = Object.fromEntries(new FormData(e.target));
  dados.criadoEm = new Date().toLocaleString();

  push(ref(db, "avaliacoes"), dados)
    .then(()=>{
      alert("‚úÖ Avalia√ß√£o salva com sucesso!");
      e.target.reset();
      voltarMenu();
    })
    .catch((erro)=>{
      alert("Erro ao salvar: " + erro.message);
    });
}

/* ===== CARREGAR ===== */

function carregar(){

  const lista = document.getElementById("listaContainer");
  lista.innerHTML = "Carregando...";

  onValue(ref(db, "avaliacoes"), snapshot => {

    lista.innerHTML = "";

    if(!snapshot.exists()){
      lista.innerHTML = "Nenhuma avalia√ß√£o encontrada.";
      return;
    }

    snapshot.forEach(child => {
      const dados = child.val();

      lista.innerHTML += `
        <div class="card">
          <strong>${dados.nome}</strong><br>
          Tipo: ${dados.tipo}<br>
          <small>${dados.criadoEm}</small>
        </div>
      `;
    });

  });

}

</script>

</body>
</html>


