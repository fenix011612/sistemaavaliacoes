<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sistema de Avalia√ß√µes</title>

<style>
:root{
  --lilas:#7b6cf6;
  --ciano:#00cfe8;
  --bg:#f4f6fb;
}

body{
  margin:0;
  font-family:'Segoe UI',sans-serif;
  background:var(--bg);
}

header{
  background:linear-gradient(135deg,var(--lilas),var(--ciano));
  padding:25px;
  color:white;
  text-align:center;
  font-size:22px;
  font-weight:bold;
  box-shadow:0 4px 12px rgba(0,0,0,0.2);
}

.container{
  max-width:1100px;
  margin:30px auto;
  padding:20px;
}

.card{
  background:white;
  border-radius:16px;
  padding:20px;
  margin-bottom:20px;
  box-shadow:0 8px 25px rgba(0,0,0,0.08);
}

h3{
  color:var(--lilas);
  margin-top:0;
}

input,select,textarea{
  width:100%;
  padding:10px;
  border-radius:8px;
  border:1px solid #ddd;
  margin:6px 0;
}

textarea{min-height:150px;}

button{
  padding:8px 14px;
  border:none;
  border-radius:8px;
  cursor:pointer;
  margin:4px 2px;
}

.btn-primary{
  background:linear-gradient(135deg,var(--lilas),var(--ciano));
  color:white;
}

.btn-danger{background:#e53935;color:white;}
.btn-edit{background:#1e88e5;color:white;}
.btn-secondary{background:#757575;color:white;}

.modelo-box{
  background:#f2f3ff;
  padding:15px;
  border-radius:10px;
  margin-top:15px;
  border-left:4px solid var(--ciano);
}
</style>
</head>

<body>

<header>
Sistema de Avalia√ß√µes
</header>

<div class="container">

<!-- NOVA AVALIA√á√ÉO -->
<div class="card">
<h3>Nova Avalia√ß√£o</h3>

<input type="text" id="nome" placeholder="Nome do paciente/aluno">

<select id="tipo" onchange="mostrarModelo()">
<option value="fisio">Fisioterapia</option>
<option value="pilates">Pilates</option>
<option value="pelvica">P√©lvica</option>
<option value="recovery">Recovery</option>
</select>

<!-- √ÅREA DIN√ÇMICA PARA MODELOS -->
<div id="areaModelos"></div>

<button class="btn-primary" onclick="salvar()">Salvar Avalia√ß√£o</button>
</div>

<!-- LISTA -->
<div class="card">
<h3>Pesquisar Avalia√ß√µes</h3>

<input type="text" id="filtroNome" placeholder="Buscar por nome">
<select id="filtroTipo">
<option value="">Todos</option>
<option value="fisio">Fisio</option>
<option value="pilates">Pilates</option>
<option value="pelvica">P√©lvica</option>
<option value="recovery">Recovery</option>
</select>

<button class="btn-secondary" onclick="carregar()">Buscar</button>

<div id="listaContainer"></div>
</div>

</div>

<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getDatabase, ref, push, set, onValue, remove, update } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

const firebaseConfig = {
  apiKey: "AIzaSyAFNuEzaEvvpBKBGNG7NUf3zt74Q3r1fdo",
  authDomain: "sistemaavaliacoes-26513.firebaseapp.com",
  databaseURL: "https://sistemaavaliacoes-26513-default-rtdb.firebaseio.com",
  projectId: "sistemaavaliacoes-26513",
  storageBucket: "sistemaavaliacoes-26513.firebasestorage.app",
  messagingSenderId: "451297691104",
  appId: "1:451297691104:web:1f886ad169a54c4f8fd785"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

/* MOSTRAR MODELO CONFORME TIPO */
window.mostrarModelo = function(){

  const tipo = document.getElementById("tipo").value;
  const area = document.getElementById("areaModelos");

  let html = "";

  if(tipo==="fisio"){
    html = `
      <div class="modelo-box">
        <h4>Modelo Fisioterapia</h4>
        <!-- FUTUROS CAMPOS FISIOTERAPIA AQUI -->
        <p style="color:#888;">(Campos espec√≠ficos da avalia√ß√£o fisioterap√™utica entrar√£o aqui)</p>
      </div>
    `;
  }

  if(tipo==="pilates"){
    html = `
      <div class="modelo-box">
        <h4>Modelo Pilates</h4>
        <!-- FUTUROS CAMPOS PILATES AQUI -->
        <p style="color:#888;">(Campos espec√≠ficos da avalia√ß√£o de Pilates entrar√£o aqui)</p>
      </div>
    `;
  }

  if(tipo==="pelvica"){
    html = `
      <div class="modelo-box">
        <h4>Modelo P√©lvica</h4>
        <!-- FUTUROS CAMPOS P√âLVICA AQUI -->
        <p style="color:#888;">(Campos espec√≠ficos da avalia√ß√£o p√©lvica entrar√£o aqui)</p>
      </div>
    `;
  }

  if(tipo==="recovery"){
    html = `
      <div class="modelo-box">
        <h4>Modelo Recovery</h4>
        <!-- FUTUROS CAMPOS RECOVERY AQUI -->
        <p style="color:#888;">(Campos espec√≠ficos da avalia√ß√£o Recovery entrar√£o aqui)</p>
      </div>
    `;
  }

  area.innerHTML = html;
}

/* SALVAR */
window.salvar = function(){

  const nome = document.getElementById("nome").value;
  const tipo = document.getElementById("tipo").value;

  if(!nome){alert("Digite o nome!");return;}

  const novaRef = push(ref(db,`avaliacoes/${tipo}`));

  set(novaRef,{
    nome,
    tipo,
    criadoEm:new Date().toLocaleString()
  });

  alert("Salvo com sucesso üíú");
  document.getElementById("nome").value="";
}

/* CARREGAR */
window.carregar = function(){

  const listaDiv = document.getElementById("listaContainer");
  const filtroNome = document.getElementById("filtroNome").value.toLowerCase();
  const filtroTipo = document.getElementById("filtroTipo").value;

  listaDiv.innerHTML="Carregando...";

  onValue(ref(db,"avaliacoes"), snapshot=>{

    listaDiv.innerHTML="";
    let todas=[];

    snapshot.forEach(child=>{
      child.forEach(sub=>{
        todas.push({
          id:sub.key,
          tipo:child.key,
          ...sub.val()
        });
      });
    });

    const filtradas = todas.filter(item=>{
      if(filtroTipo && item.tipo!==filtroTipo) return false;
      if(filtroNome && !item.nome.toLowerCase().includes(filtroNome)) return false;
      return true;
    });

    if(filtradas.length===0){
      listaDiv.innerHTML="Nenhuma avalia√ß√£o encontrada.";
      return;
    }

    filtradas.forEach(dados=>{
      listaDiv.innerHTML+=`
      <div class="card">
        <strong>${dados.nome}</strong><br>
        Tipo: ${dados.tipo}<br>
        <small>${dados.criadoEm}</small><br><br>

        <button class="btn-edit" onclick="editar('${dados.tipo}','${dados.id}','${dados.nome}')">Editar</button>
        <button class="btn-danger" onclick="excluir('${dados.tipo}','${dados.id}')">Excluir</button>
      </div>
      `;
    });

  },{onlyOnce:true});
}

window.excluir = function(tipo,id){
  if(confirm("Excluir avalia√ß√£o?")){
    remove(ref(db,`avaliacoes/${tipo}/${id}`));
    carregar();
  }
}

window.editar = function(tipo,id,nomeAtual){
  const novoNome = prompt("Editar nome:",nomeAtual);
  if(novoNome){
    update(ref(db,`avaliacoes/${tipo}/${id}`),{nome:novoNome});
    carregar();
  }
}

</script>

</body>
</html>






