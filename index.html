<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Sistema de Avalia√ß√µes</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root{
  --lilas:#7b6cf6;
  --ciano:#00cfe8;
  --fundo:#f4f6fb;
}
body{
  margin:0;
  font-family:Arial, sans-serif;
  background:var(--fundo);
}
header{
  background:linear-gradient(90deg,var(--lilas),var(--ciano));
  color:white;
  padding:20px;
  text-align:center;
  font-size:22px;
  font-weight:bold;
}
.container{
  padding:20px;
  max-width:900px;
  margin:auto;
}
.card{
  background:white;
  padding:20px;
  border-radius:15px;
  box-shadow:0 4px 12px rgba(0,0,0,0.1);
  margin-bottom:20px;
}
input, select, textarea{
  width:100%;
  padding:10px;
  margin-top:8px;
  margin-bottom:15px;
  border-radius:8px;
  border:1px solid #ccc;
}
button{
  background:var(--lilas);
  color:white;
  border:none;
  padding:10px 15px;
  border-radius:8px;
  cursor:pointer;
}
button:hover{ opacity:0.9; }
.hidden{ display:none; }
.lista-item{
  padding:12px;
  border-bottom:1px solid #eee;
  cursor:pointer;
}
.lista-item:hover{ background:#f0f0ff; }
</style>
</head>
<body>

<header>Sistema de Avalia√ß√µes</header>

<div class="container">

<!-- TELA INICIAL -->
<div id="telaInicial">

<div class="card">
<h3>Nova Avalia√ß√£o</h3>

<input type="text" id="nome" placeholder="Nome do paciente">

<select id="tipo">
<option value="">Selecione o tipo</option>
<option value="Fisioterapia">Fisioterapia</option>
<option value="Pilates">Pilates</option>
<option value="P√©lvica">P√©lvica</option>
<option value="Recovery">Recovery</option>
</select>

<input type="date" id="data">

<button onclick="abrirTelaPorTipo()">Continuar</button>
</div>

<div class="card">
<h3>Avalia√ß√µes Salvas</h3>

<select id="filtroTipo" onchange="carregarAvaliacoes()">
  <option value="">Todas</option>
  <option value="Fisioterapia">Fisioterapia</option>
  <option value="Pilates">Pilates</option>
  <option value="P√©lvica">P√©lvica</option>
  <option value="Recovery">Recovery</option>
</select>

<div id="listaAvaliacoes">Carregando...</div>
</div>

</div>

<!-- TELA FISIOTERAPIA -->
<div id="telaFisioterapia" class="hidden">
<div class="card">
<button onclick="voltar()">‚¨Ö Voltar</button>
<h3>FICHA DE ANAMNESE E (RE)AVALIA√á√ÉO ‚Äì FISIOTERAPIA</h3>

<!-- TIPO DE ATENDIMENTO -->
<h4>Tipo de Atendimento</h4>
<label><input type="checkbox" id="fisio_sessao"> Sess√£o</label>
<label><input type="checkbox" id="fisio_pacote"> Pacote</label>
<input type="text" id="fisio_qtdSessoes" placeholder="Quantidade de sess√µes">

<h4>Forma de Pagamento</h4>
<label><input type="checkbox" id="fisio_pix"> Pix</label>
<label><input type="checkbox" id="fisio_parcelado"> Parcelado</label>
<input type="text" id="fisio_parcelas" placeholder="Parcelado em quantas vezes">

<label>Parceria? Se sim qual?</label>
<input type="text" id="fisio_parceria">

<h4>üìå IDENTIFICA√á√ÉO</h4>

<label>Nome completo:</label>
<input type="text" id="fisio_nomeCompleto">

<label>Data de nascimento:</label>
<input type="date" id="fisio_dataNascimento">

<label>CPF:</label>
<input type="text" id="fisio_cpf">

<label>Sexo:</label>
<label><input type="checkbox" id="fisio_masculino"> Masculino</label>
<label><input type="checkbox" id="fisio_feminino"> Feminino</label>

<label>Respons√°vel (se menor):</label>
<input type="text" id="fisio_responsavel">

<label>Grau de parentesco:</label>
<input type="text" id="fisio_parentesco">

<label>CPF Respons√°vel:</label>
<input type="text" id="fisio_cpfResponsavel">

<label>Profiss√£o/Ocupa√ß√£o:</label>
<input type="text" id="fisio_profissao">

<label>Endere√ßo Residencial:</label>
<input type="text" id="fisio_endereco">

<label>Telefone:</label>
<input type="text" id="fisio_telefone">

<label>E-mail:</label>
<input type="email" id="fisio_email">

<label>Data da Avalia√ß√£o:</label>
<input type="date" id="fisio_dataAvaliacao">

<label>Diagn√≥stico Cl√≠nico:</label>
<textarea id="fisio_diagClinico"></textarea>

<label>Diagn√≥stico Fisioterap√™utico:</label>
<textarea id="fisio_diagFisio"></textarea>

<label>CBDF:</label>
<input type="text" id="fisio_cbdf">

<h4>‚öïÔ∏è HIST√ìRIA CL√çNICA</h4>

<label>Queixa Principal:</label>
<textarea id="fisio_queixaPrincipal"></textarea>

<label>HPP:</label>
<textarea id="fisio_hpp"></textarea>

<label>Antecedentes Pessoais:</label>
<textarea id="fisio_antecedentesPessoais"></textarea>

<label>Antecedentes Familiares:</label>
<textarea id="fisio_antecedentesFamiliares"></textarea>

<label>Tratamentos Realizados:</label>
<textarea id="fisio_tratamentos"></textarea>

<label>H√°bitos de vida:</label>
<textarea id="fisio_habitos"></textarea>

<label>Realiza acompanhamento?</label>
<label><input type="checkbox" id="fisio_acompanhamentoSim"> Sim</label>
<label><input type="checkbox" id="fisio_acompanhamentoNao"> N√£o</label>

<label>Qual especialidade?</label>
<input type="text" id="fisio_especialidade">

<h4>‚öïÔ∏è APRESENTA√á√ÉO DO PACIENTE</h4>

<label><input type="checkbox" id="fisio_orientado"> Deambulando e orientado</label>
<label><input type="checkbox" id="fisio_apoio"> Deambulando com apoio</label>
<label><input type="checkbox" id="fisio_confuso"> Confuso</label>
<label><input type="checkbox" id="fisio_desorientado"> Desorientado</label>

<h4>‚öïÔ∏è EXAMES COMPLEMENTARES</h4>
<label><input type="checkbox" id="fisio_examesSim"> Sim</label>
<label><input type="checkbox" id="fisio_examesNao"> N√£o</label>

<h4>‚öïÔ∏è USA MEDICAMENTOS</h4>
<label><input type="checkbox" id="fisio_medicamentoSim"> Sim</label>
<label><input type="checkbox" id="fisio_medicamentoNao"> N√£o</label>

<h4>‚öïÔ∏è REALIZOU CIRURGIA</h4>
<label><input type="checkbox" id="fisio_cirurgiaSim"> Sim</label>
<label><input type="checkbox" id="fisio_cirurgiaNao"> N√£o</label>

<label>Se sim, quais:</label>
<textarea id="fisio_cirurgias"></textarea>

<h4>‚öïÔ∏è INSPE√á√ÉO/PALPA√á√ÉO</h4>

<label><input type="checkbox" id="fisio_normal"> Normal</label>
<label><input type="checkbox" id="fisio_edema"> Edema</label>
<label><input type="checkbox" id="fisio_cicatriz"> Cicatriza√ß√£o incompleta</label>
<label><input type="checkbox" id="fisio_eritema"> Eritemas</label>
<label><input type="checkbox" id="fisio_outros"> Outros</label>

<h4>‚öïÔ∏è AVALIA√á√ÉO F√çSICA</h4>

<label>Peso:</label>
<input type="number" id="fisio_peso">

<label>Altura:</label>
<input type="number" id="fisio_altura">

<h4>üìå TESTES FISIOTERAP√äUTICOS</h4>

<label>Y Balance:</label>
<label><input type="checkbox" id="fisio_y_risco"> Sim com risco</label>
<label><input type="checkbox" id="fisio_y_nao"> N√£o</label>

<label>Romberg:</label>
<label><input type="checkbox" id="fisio_romberg_pos"> Positivo</label>
<label><input type="checkbox" id="fisio_romberg_neg"> Negativo</label>

<label>TUG:</label>
<label><input type="checkbox" id="fisio_tug_normal"> Normal</label>
<label><input type="checkbox" id="fisio_tug_baixo"> Baixo risco</label>
<label><input type="checkbox" id="fisio_tug_medio"> M√©dio risco</label>
<label><input type="checkbox" id="fisio_tug_alto"> Alto risco</label>

<label>Lasegue:</label>
<label><input type="checkbox" id="fisio_lasegue_pos"> Positivo</label>
<label><input type="checkbox" id="fisio_lasegue_neg"> Negativo</label>

<h4>‚öïÔ∏è ESCALA DE FOR√áA MUSCULAR</h4>
<label><input type="checkbox" id="fisio_g0"> Grau 0</label>
<label><input type="checkbox" id="fisio_g1"> Grau 1</label>
<label><input type="checkbox" id="fisio_g2"> Grau 2</label>
<label><input type="checkbox" id="fisio_g3"> Grau 3</label>
<label><input type="checkbox" id="fisio_g4"> Grau 4</label>
<label><input type="checkbox" id="fisio_g5"> Grau 5</label>

<h4>üìå PLANO TERAP√äUTICO</h4>

<label>Objetivos do Tratamento:</label>
<textarea id="fisio_objetivos"></textarea>

<label>Recursos Terap√™uticos:</label>
<textarea id="fisio_recursos"></textarea>

<label>Plano do Tratamento:</label>
<textarea id="fisio_planoTratamento"></textarea>

<label>Profissional / Registro Conselho:</label>
<input type="text" id="fisio_profissional">

<button onclick="salvarFisioterapia()">Salvar Avalia√ß√£o</button>
</div>
</div>

<!-- TELA PILATES -->
<div id="telaPilates" class="hidden">
<div class="card">
<button onclick="voltar()">‚¨Ö Voltar</button>
<h3>Avalia√ß√£o Pilates</h3>

<textarea id="pilates_objetivo" placeholder="Objetivo"></textarea>
<textarea id="pilates_restricoes" placeholder="Restri√ß√µes"></textarea>

<button onclick="salvarPilates()">Salvar</button>
</div>
</div>

<!-- TELA RECOVERY -->
<div id="telaRecovery" class="hidden">
<div class="card">
<button onclick="voltar()">‚¨Ö Voltar</button>
<h3>Avalia√ß√£o Recovery</h3>

<input type="text" id="recovery_tipo" placeholder="Tipo de Recovery">
<textarea id="recovery_obs" placeholder="Observa√ß√µes"></textarea>

<button onclick="salvarRecovery()">Salvar</button>
</div>
</div>

<!-- TELA P√âLVICA -->
<div id="telaPelvica" class="hidden">
<div class="card">
<button onclick="voltar()">‚¨Ö Voltar</button>
<h3>Avalia√ß√£o P√©lvica</h3>

<textarea id="pelvica_queixa" placeholder="Queixa P√©lvica"></textarea>
<textarea id="pelvica_hist" placeholder="Hist√≥rico"></textarea>

<button onclick="salvarPelvica()">Salvar</button>
</div>
</div>

<!-- TELA DETALHE -->
<div id="telaDetalhe" class="hidden">
<div class="card">
<button onclick="voltar()">‚¨Ö Voltar</button>
<h3 id="tituloDetalhe"></h3>
<div id="dadosAvaliacao"></div>

<div id="evolucoes"></div>

<h4>Nova Evolu√ß√£o</h4>
<textarea id="textoEvolucao"></textarea>
<button onclick="salvarEvolucao()">Salvar Evolu√ß√£o</button>
</div>
</div>

</div>

<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
import { getDatabase, ref, push, set, onValue } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-database.js";

const firebaseConfig = {
  apiKey: "AIzaSyAFNuEzaEvvpBKBGNG7NUf3zt74Q3r1fdo",
  authDomain: "sistemaavaliacoes-26513.firebaseapp.com",
  databaseURL: "https://sistemaavaliacoes-26513-default-rtdb.firebaseio.com",
  projectId: "sistemaavaliacoes-26513",
  storageBucket: "sistemaavaliacoes-26513.firebasestorage.app",
  messagingSenderId: "451297691104",
  appId: "1:451297691104:web:1f886ad169a54c4f8fd785"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

let tempNome, tempTipo, tempData;
let avaliacaoAtualId = null;

/* ABRIR TELA POR TIPO */
window.abrirTelaPorTipo = function(){

tempNome = nome.value;
tempTipo = tipo.value;
tempData = data.value;

if(!tempNome || !tempTipo || !tempData){
alert("Preencha todos os campos.");
return;
}

telaInicial.classList.add("hidden");

document.getElementById("tela"+tempTipo.replace("√ß","c").replace("√©","e")).classList.remove("hidden");
};

/* SALVAMENTOS */
function salvarBase(dadosExtras){

const novaRef = push(ref(db,"avaliacoes"));

set(novaRef,{
nome: tempNome,
tipo: tempTipo,
data: tempData,
...dadosExtras,
criadoEm:new Date().toLocaleString()
});

alert("Avalia√ß√£o salva!");
voltar();
}

window.salvarFisioterapia = function(){

salvarBase({

sessao: fisio_sessao.checked,
pacote: fisio_pacote.checked,
qtdSessoes: fisio_qtdSessoes.value,
pix: fisio_pix.checked,
parcelado: fisio_parcelado.checked,
parcelas: fisio_parcelas.value,
parceria: fisio_parceria.value,

nomeCompleto: fisio_nomeCompleto.value,
dataNascimento: fisio_dataNascimento.value,
cpf: fisio_cpf.value,
masculino: fisio_masculino.checked,
feminino: fisio_feminino.checked,
responsavel: fisio_responsavel.value,
parentesco: fisio_parentesco.value,
cpfResponsavel: fisio_cpfResponsavel.value,
profissao: fisio_profissao.value,
endereco: fisio_endereco.value,
telefone: fisio_telefone.value,
email: fisio_email.value,
dataAvaliacao: fisio_dataAvaliacao.value,
diagnosticoClinico: fisio_diagClinico.value,
diagnosticoFisio: fisio_diagFisio.value,
cbdf: fisio_cbdf.value,

queixaPrincipal: fisio_queixaPrincipal.value,
hpp: fisio_hpp.value,
antecedentesPessoais: fisio_antecedentesPessoais.value,
antecedentesFamiliares: fisio_antecedentesFamiliares.value,
tratamentos: fisio_tratamentos.value,
habitos: fisio_habitos.value,
acompanhamentoSim: fisio_acompanhamentoSim.checked,
acompanhamentoNao: fisio_acompanhamentoNao.checked,
especialidade: fisio_especialidade.value,

orientado: fisio_orientado.checked,
apoio: fisio_apoio.checked,
confuso: fisio_confuso.checked,
desorientado: fisio_desorientado.checked,

examesSim: fisio_examesSim.checked,
examesNao: fisio_examesNao.checked,
medicamentoSim: fisio_medicamentoSim.checked,
medicamentoNao: fisio_medicamentoNao.checked,
cirurgiaSim: fisio_cirurgiaSim.checked,
cirurgiaNao: fisio_cirurgiaNao.checked,
cirurgias: fisio_cirurgias.value,

normal: fisio_normal.checked,
edema: fisio_edema.checked,
cicatriz: fisio_cicatriz.checked,
eritema: fisio_eritema.checked,
outros: fisio_outros.checked,

peso: fisio_peso.value,
altura: fisio_altura.value,

yRisco: fisio_y_risco.checked,
yNao: fisio_y_nao.checked,
rombergPos: fisio_romberg_pos.checked,
rombergNeg: fisio_romberg_neg.checked,
tugNormal: fisio_tug_normal.checked,
tugBaixo: fisio_tug_baixo.checked,
tugMedio: fisio_tug_medio.checked,
tugAlto: fisio_tug_alto.checked,
laseguePos: fisio_lasegue_pos.checked,
lasegueNeg: fisio_lasegue_neg.checked,

g0: fisio_g0.checked,
g1: fisio_g1.checked,
g2: fisio_g2.checked,
g3: fisio_g3.checked,
g4: fisio_g4.checked,
g5: fisio_g5.checked,

objetivos: fisio_objetivos.value,
recursos: fisio_recursos.value,
planoTratamento: fisio_planoTratamento.value,
profissional: fisio_profissional.value

});
};

window.salvarPilates = function(){
salvarBase({
objetivo:pilates_objetivo.value,
restricoes:pilates_restricoes.value
});
};

window.salvarRecovery = function(){
salvarBase({
tipoRecovery:recovery_tipo.value,
obs:recovery_obs.value
});
};

window.salvarPelvica = function(){
salvarBase({
queixa:pelvica_queixa.value,
historico:pelvica_hist.value
});
};

/* LISTA */
window.carregarAvaliacoes = function(){

const filtro = filtroTipo.value;

onValue(ref(db,"avaliacoes"),(snapshot)=>{

listaAvaliacoes.innerHTML="";

if(!snapshot.exists()){
listaAvaliacoes.innerHTML="Nenhuma avalia√ß√£o.";
return;
}

snapshot.forEach((child)=>{
const dados=child.val();
if(filtro && dados.tipo !== filtro) return;

const div=document.createElement("div");
div.className="lista-item";
div.innerHTML=`<strong>${dados.nome}</strong> - ${dados.tipo}`;
div.onclick=()=>abrirDetalhe(child.key,dados);
listaAvaliacoes.appendChild(div);
});
});
};

window.abrirDetalhe=function(id,dados){

avaliacaoAtualId=id;

telaInicial.classList.add("hidden");
telaDetalhe.classList.remove("hidden");

tituloDetalhe.innerText=`${dados.nome} - ${dados.tipo}`;

let html=`<p><strong>Data:</strong> ${dados.data}</p>`;

for (const key in dados){
if(!["nome","tipo","data","criadoEm"].includes(key)){
html+=`<p><strong>${key}:</strong> ${dados[key]}</p>`;
}
}

dadosAvaliacao.innerHTML=html;
carregarEvolucoes();
};

function carregarEvolucoes(){

evolucoes.innerHTML="<h4>Evolu√ß√µes</h4>";

onValue(ref(db,`avaliacoes/${avaliacaoAtualId}/evolucoes`),(snapshot)=>{
if(!snapshot.exists()){
evolucoes.innerHTML+="Nenhuma evolu√ß√£o.";
return;
}
snapshot.forEach((child)=>{
const evo=child.val();
evolucoes.innerHTML+=`
<p><strong>${evo.data}</strong><br>${evo.texto}<hr></p>`;
});
});
}

window.salvarEvolucao=function(){

if(!textoEvolucao.value) return;

const novaRef=push(ref(db,`avaliacoes/${avaliacaoAtualId}/evolucoes`));

set(novaRef,{
texto:textoEvolucao.value,
data:new Date().toLocaleDateString()
});

textoEvolucao.value="";
};

window.voltar=function(){

telaInicial.classList.remove("hidden");
telaFisioterapia.classList.add("hidden");
telaPilates.classList.add("hidden");
telaRecovery.classList.add("hidden");
telaPelvica.classList.add("hidden");
telaDetalhe.classList.add("hidden");
};

carregarAvaliacoes();

</script>
</body>
</html>






