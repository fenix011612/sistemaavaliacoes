<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Sistema de Avaliações</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root{
  --lilas:#7b6cf6;
  --ciano:#00cfe8;
  --fundo:#f4f6fb;
}
body{
  margin:0;
  font-family:Arial, sans-serif;
  background:var(--fundo);
}
header{
  background:linear-gradient(90deg,var(--lilas),var(--ciano));
  color:white;
  padding:20px;
  text-align:center;
  font-size:22px;
  font-weight:bold;
}
.container{
  padding:20px;
  max-width:900px;
  margin:auto;
}
.card{
  background:white;
  padding:20px;
  border-radius:15px;
  box-shadow:0 4px 12px rgba(0,0,0,0.1);
  margin-bottom:20px;
}
input, select, textarea{
  width:100%;
  padding:10px;
  margin-top:8px;
  margin-bottom:15px;
  border-radius:8px;
  border:1px solid #ccc;
}
button{
  background:var(--lilas);
  color:white;
  border:none;
  padding:10px 15px;
  border-radius:8px;
  cursor:pointer;
}
button:hover{ opacity:0.9; }
.hidden{ display:none; }
.lista-item{
  padding:12px;
  border-bottom:1px solid #eee;
  cursor:pointer;
}
.lista-item:hover{ background:#f0f0ff; }
</style>
</head>
<body>

<header>Sistema de Avaliações</header>

<div class="container">

<div class="card">
<h3>Nova Avaliação</h3>

<input type="text" id="nome" placeholder="Nome do paciente">

<select id="tipo" onchange="mostrarCampos()">
<option value="">Selecione o tipo</option>
<option value="Fisioterapia">Fisioterapia</option>
<option value="Pilates">Pilates</option>
<option value="Pélvica">Pélvica</option>
<option value="Recovery">Recovery</option>
</select>

<input type="date" id="data">

<!-- FISIOTERAPIA -->
<div id="fisioCampos" class="hidden">
<h4>Fisioterapia</h4>
<input type="text" id="fisioQueixa" placeholder="Queixa principal">
<textarea id="fisioDiagnostico" placeholder="Diagnóstico"></textarea>
<textarea id="fisioPlano" placeholder="Plano de tratamento"></textarea>
</div>

<!-- PILATES -->
<div id="pilatesCampos" class="hidden">
<h4>Pilates</h4>
<input type="text" id="pilatesObjetivo" placeholder="Objetivo do aluno">
<textarea id="pilatesPostural" placeholder="Avaliação postural"></textarea>
</div>

<!-- PÉLVICA -->
<div id="pelvicaCampos" class="hidden">
<h4>Pélvica</h4>
<input type="text" id="pelvicaHistorico" placeholder="Histórico obstétrico">
<textarea id="pelvicaSintomas" placeholder="Sintomas"></textarea>
</div>

<!-- RECOVERY -->
<div id="recoveryCampos" class="hidden">
<h4>Recovery</h4>
<input type="text" id="recoveryRegiao" placeholder="Região tratada">
<textarea id="recoveryDor" placeholder="Tipo de dor"></textarea>
</div>

<button onclick="salvarAvaliacao()">Salvar Avaliação</button>
</div>

<div class="card">
<h3>Avaliações Salvas</h3>
<div id="listaAvaliacoes">Carregando...</div>
</div>

</div>

<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
import { getDatabase, ref, push, set, onValue } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-database.js";

const firebaseConfig = {
  apiKey: "AIzaSyAFNuEzaEvvpBKBGNG7NUf3zt74Q3r1fdo",
  authDomain: "sistemaavaliacoes-26513.firebaseapp.com",
  databaseURL: "https://sistemaavaliacoes-26513-default-rtdb.firebaseio.com",
  projectId: "sistemaavaliacoes-26513",
  storageBucket: "sistemaavaliacoes-26513.firebasestorage.app",
  messagingSenderId: "451297691104",
  appId: "1:451297691104:web:1f886ad169a54c4f8fd785"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

/* MOSTRAR CAMPOS */
window.mostrarCampos = function(){

["fisioCampos","pilatesCampos","pelvicaCampos","recoveryCampos"]
.forEach(id => document.getElementById(id).classList.add("hidden"));

const tipo = document.getElementById("tipo").value;

if(tipo==="Fisioterapia") document.getElementById("fisioCampos").classList.remove("hidden");
if(tipo==="Pilates") document.getElementById("pilatesCampos").classList.remove("hidden");
if(tipo==="Pélvica") document.getElementById("pelvicaCampos").classList.remove("hidden");
if(tipo==="Recovery") document.getElementById("recoveryCampos").classList.remove("hidden");
};

/* SALVAR AVALIAÇÃO */
window.salvarAvaliacao = function(){

const nome = document.getElementById("nome").value;
const tipo = document.getElementById("tipo").value;
const data = document.getElementById("data").value;

if(!nome || !tipo || !data){
alert("Preencha nome, tipo e data.");
return;
}

let dadosEspecificos = {};

if(tipo==="Fisioterapia"){
dadosEspecificos = {
queixa: document.getElementById("fisioQueixa").value,
diagnostico: document.getElementById("fisioDiagnostico").value,
plano: document.getElementById("fisioPlano").value
};
}

if(tipo==="Pilates"){
dadosEspecificos = {
objetivo: document.getElementById("pilatesObjetivo").value,
postural: document.getElementById("pilatesPostural").value
};
}

if(tipo==="Pélvica"){
dadosEspecificos = {
historico: document.getElementById("pelvicaHistorico").value,
sintomas: document.getElementById("pelvicaSintomas").value
};
}

if(tipo==="Recovery"){
dadosEspecificos = {
regiao: document.getElementById("recoveryRegiao").value,
dor: document.getElementById("recoveryDor").value
};
}

const novaRef = push(ref(db, "avaliacoes"));

set(novaRef,{
nome,
tipo,
data,
dadosEspecificos,
criadoEm:new Date().toLocaleString()
});

alert("Avaliação salva!");

document.querySelectorAll("input, textarea").forEach(el => el.value="");
document.getElementById("tipo").value="";
mostrarCampos();
};

/* CARREGAR */
function carregarAvaliacoes(){

onValue(ref(db,"avaliacoes"),(snapshot)=>{

const lista=document.getElementById("listaAvaliacoes");
lista.innerHTML="";

if(!snapshot.exists()){
lista.innerHTML="Nenhuma avaliação encontrada.";
return;
}

snapshot.forEach((child)=>{
const dados=child.val();
const div=document.createElement("div");
div.className="lista-item";
div.innerHTML=`<strong>${dados.nome}</strong> - ${dados.tipo}`;
lista.appendChild(div);
});

});
}

carregarAvaliacoes();

</script>
</body>
</html>
